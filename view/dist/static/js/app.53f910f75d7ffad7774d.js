webpackJsonp([2],{0:function(e,t){},"04pQ":function(e,t,a){"use strict";var n={name:"vue-particles",props:{color:{type:String,default:"#dedede"},particleOpacity:{type:Number,default:.7},particlesNumber:{type:Number,default:80},shapeType:{type:String,default:"circle"},particleSize:{type:Number,default:4},linesColor:{type:String,default:"#dedede"},linesWidth:{type:Number,default:1},lineLinked:{type:Boolean,default:!0},lineOpacity:{type:Number,default:.4},linesDistance:{type:Number,default:150},moveSpeed:{type:Number,default:3},hoverEffect:{type:Boolean,default:!0},hoverMode:{type:String,default:"grab"},clickEffect:{type:Boolean,default:!0},clickMode:{type:String,default:"push"}},mounted:function(){var e=this;a("9B60"),this.$nextTick(function(){e.initParticleJS(e.color,e.particleOpacity,e.particlesNumber,e.shapeType,e.particleSize,e.linesColor,e.linesWidth,e.lineLinked,e.lineOpacity,e.linesDistance,e.moveSpeed,e.hoverEffect,e.hoverMode,e.clickEffect,e.clickMode)})},methods:{initParticleJS:function(e,t,a,n,i,s,o,r,c,l,u,d,f,p,m){particlesJS("particles-js",{particles:{number:{value:a,density:{enable:!0,value_area:800}},color:{value:e},shape:{type:n,stroke:{width:0,color:"#192231"},polygon:{nb_sides:5}},opacity:{value:t,random:!1,anim:{enable:!1,speed:1,opacity_min:.1,sync:!1}},size:{value:i,random:!0,anim:{enable:!1,speed:40,size_min:.1,sync:!1}},line_linked:{enable:r,distance:l,color:s,opacity:c,width:o},move:{enable:!0,speed:u,direction:"none",random:!1,straight:!1,out_mode:"out",bounce:!1,attract:{enable:!1,rotateX:600,rotateY:1200}}},interactivity:{detect_on:"canvas",events:{onhover:{enable:d,mode:f},onclick:{enable:p,mode:m},onresize:{enable:!0,density_auto:!0,density_area:400}},modes:{grab:{distance:140,line_linked:{opacity:1}},bubble:{distance:400,size:40,duration:2,opacity:8,speed:3},repulse:{distance:200,duration:.4},push:{particles_nb:4},remove:{particles_nb:2}}},retina_detect:!0})}}},i={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{attrs:{id:"particles-js",color:e.color,particleOpacity:e.particleOpacity,linesColor:e.linesColor,particlesNumber:e.particlesNumber,shapeType:e.shapeType,particleSize:e.particleSize,linesWidth:e.linesWidth,lineLinked:e.lineLinked,lineOpacity:e.lineOpacity,linesDistance:e.linesDistance,moveSpeed:e.moveSpeed,hoverEffect:e.hoverEffect,hoverMode:e.hoverMode,clickEffect:e.clickEffect,clickMode:e.clickMode}})},staticRenderFns:[]},s=a("VU/8")(n,i,!1,null,null,null);t.a=s.exports},"51NV":function(e,t){},"7MWu":function(e,t){},Hbln:function(e,t){},Ifj2:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("7+uW"),i={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var s=a("VU/8")({name:"App"},i,!1,function(e){a("U4/P")},null,null).exports,o=a("tD9O"),r=a.n(o),c=(a("Ifj2"),a("zL8q")),l=a.n(c),u=(a("tvR6"),a("Hbln"),a("51NV"),a("/ocq")),d=a("mvHQ"),f=a.n(d),p=JSON.parse(localStorage.getItem("access-user")),m="ws://182.254.245.219:8502/ws",h=null,v=!1,g=!1,y=function(e){if(!p)return!1;try{"WebSocket"in window?h=new WebSocket(e+"?token="+p.token):"MozWebSocket"in window&&(h=new MozWebSocket(e+"?token="+p.token)),b()}catch(t){_(e)}},b=function(){h.onopen=function(){console.log("socket连接成功"),g&&(g=!1)},h.onerror=function(){console.log("websocket服务出错了---onerror"),_(m)},h.onclose=function(){console.log("websocket服务关闭了+++onclose"),_(m)}},_=function(e){if(v)return!1;g=!0,v=!0,setTimeout(function(){y(e),v=!1},2e3)},k=function e(t){if(1!==h.readyState)return setTimeout(function(){console.log("等待socket链接成功"),e(t)},1500),!1;t,t=f()(t),h.send(t)},C=function(e){h.onmessage=function(t){e&&e(t)}},w=y,S=m,x=a("//Fk"),N=a.n(x),O=a("mtWM"),M=a.n(O),I="";M.a.defaults.withCredentials=!1,M.a.defaults.headers.post["Content-Type"]="application/json;charset=UTF-8",M.a.interceptors.request.use(function(e){var t=JSON.parse(localStorage.getItem("access-user"));return t&&(I=t.token),I&&(e.headers.common.Authorization="Bearer "+I),e},function(e){return console.info("error: "),console.info(e),N.a.reject(e)}),M.a.interceptors.response.use(function(e){return e.data&&e.data.code&&(108!==parseInt(e.data.code)&&109!==parseInt(e.data.code)&&"鉴权失败，Token 超时"!==e.data.msg&&"鉴权失败，Token 错误"!==e.data.msg||(e.data.msg="登录信息已失效，请重新登录",l.a.Message.error(e.data.msg),be.push("/login")),-1===parseInt(e.data.code)&&l.a.Message.error("请求失败")),e},function(e){return console.dir(e),l.a.Message.error("服务器连接失败"),N.a.reject(e)});var $="http://182.254.245.219:8502/",E=function(e,t){var a=(new Date).getTime();return M.a.post(""+$+e+"?timer="+a,t).then(function(e){return e.data})},U=function(e,t,a){var n=(new Date).getTime();return M.a.post(""+$+e+"?timer="+n,t,a).then(function(e){return e.data})},V=function(e){return E("im/login",e)},T=function(e){return E("im/get_user_contacts",e)},B=function(e){return E("im/get_messages",e)},z=function(e,t){return U("im/upload_avatar",e,t)},D=function(e){return E("im/update_userinfo",e)},L=function(e,t){return U("im/upload_chat_image",e,t)},A=function(e){return E("im/create_group",e)},F=function(e){return E("im/get_group_contacts",e)},W=function(e){return E("im/add_group_members",e)},j=function(e){return E("im/upload_group",e)},J=function(e){return E("im/get_message_info",e)},P=function(e,t){t.updateContact({id:e.id,unread:0}),t.closeDrawer()},R=function(e,t,a){var n={contact_id:e.id,type:e.type};B(n).then(function(e){0===e.code&&Array.isArray(e.data)&&e.data.length>0&&(a.messages=e.data),t(a.messages,!0)})},q=function(e){var t=JSON.parse(localStorage.getItem("access-user"));t&&(e.user.id=t.id,e.user.displayName=t.displayName,e.user.avatar=t.avatar)},H=function(e){var t="";try{var a=e.split(".");t=a[a.length-1]}catch(e){t=""}if(!t)return!1;if(["png","jpg","jpeg","bmp","gif"].some(function(e){return e==t}))return"image";if(["txt"].some(function(e){return e==t}))return"txt";if(["xls","xlsx"].some(function(e){return e==t}))return"excel";if(["doc","docx"].some(function(e){return e==t}))return"word";if(["pdf"].some(function(e){return e==t}))return"pdf";if(["ppt"].some(function(e){return e==t}))return"ppt";if(["mp4","m2v","mkv"].some(function(e){return e==t}))return"video";return["mp3","wav","wmv"].some(function(e){return e==t})?"radio":"other"},G=function(e,t,a){if("video"==H(e.fileName)){a.videoOptions.sources=[],a.showVideo=!0;var n={src:t,type:"video/mp4"};a.videoOptions.sources.push(n)}},X=function(e,t,a){if(t&&("image"==e.type||"file"==e.type)){var n=new FormData;n.append("file",t,t.name),n.append("chat_id",e.id),L(n,{headers:{"Content-Type":"multipart/form-data; boundary=----WebKitFormBoundaryVCFSAonTuDbVCoAN"}}).then(function(e){0!=e.code&&(a.imageSuccess=!1)})}},Q=function(e,t){var a=e.content;a?G(e,a,t):J({message_id:e.id}).then(function(a){0===a.code&&G(e,a.data.url,t)})},Y={data:function(){return{name:"",formLabelWidth:"80px",timer:null,loading:!1,imageUrl:""}},mounted:function(){var e=JSON.parse(localStorage.getItem("access-user"));this.name=e.displayName?e.displayName:"",this.imageUrl=e.avatar?e.avatar:""},methods:{confirmSubmit:function(){var e={account:this.name,avatar:this.imageUrl},t=this;D(e).then(function(e){if(0===e.code){var a=JSON.parse(localStorage.getItem("access-user"));a.displayName=e.data.account,a.avatar=e.data.avatar,localStorage.setItem("access-user",f()(a)),t.$emit("userInfoEdit",a),t.$emit("userInfoClose")}else t.$message.error(e.msg)})},cancelForm:function(){this.loading=!1,this.$emit("userInfoClose"),clearTimeout(this.timer)},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,a=e.size/1024/1024<2;if(!t)return this.$message.error("上传头像图片只能是 JPG 格式!"),!1;if(!a)return this.$message.error("上传头像图片大小不能超过 2MB!"),!1;var n=new FormData,i=this;n.append("file",e,e.name),z(n,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){0===e.code&&(i.imageUrl=e.data.AccessUrl)}).catch(function(e){i.$message.error("上传文件超时！")})}}},Z={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"demo-drawer__content"},[a("el-form",[a("el-form-item",{attrs:{label:"用户账号","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户头像","label-width":e.formLabelWidth}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"#","show-file-list":!1,"before-upload":e.beforeAvatarUpload}},[e.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),e._v(" "),a("div",{staticClass:"demo-drawer__footer"},[a("el-button",{on:{click:e.cancelForm}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirmSubmit}},[e._v(e._s(e.loading?"提交中 ...":"确 定"))])],1)],1)},staticRenderFns:[]};var K=a("VU/8")(Y,Z,!1,function(e){a("XTZt")},null,null).exports,ee={data:function(){return{data:[],checkOne:[],selectOne:[]}},props:["contact"],mounted:function(){this.load()},beforeUpdate:function(){},updated:function(){},watch:{},methods:{load:function(){var e=this;T().then(function(t){0===t.code&&t.data.forEach(function(t){var a={key:t.uuid,label:t.username,avatar:t.avatar,disabled:!1,checked:!1};e.data.push(a)})})},onCreate:function(){var e=this;if(this.data.forEach(function(t,a){t.key==e.contact.onMember[0]&&e.checkOne.push(t)}),this.checkOne.length<2)return this.$message.error("人数不够组群"),!1;if("group"===this.contact.type)return this.$message.error("不能创建群"),!1;var t=[];this.checkOne.forEach(function(e,a){t.push(e.key)}),A({contact_ids:t}).then(function(a){if(0===a.code){var n={type:"create_group",id:a.data.uuid,members:t};k(n),e.$emit("close")}})},onAdd:function(){var e=this,t=[];this.checkOne.forEach(function(e,a){t.push(e.key)});var a={group_id:this.contact.id,contact_ids:t};W(a).then(function(a){if(0===a.code){var n={type:"add_member",id:a.data.uuid,members:t};k(n),e.$emit("close")}})},close:function(){this.$emit("close")},handleCheckedCitiesChange:function(e){if(this.checkOne.includes(e)){var t=this.checkOne.indexOf(e);this.checkOne.splice(t,1)}else this.checkOne.push(e)},deleteMember:function(e){if(this.selectOne.includes(e.label)){var t=this.selectOne.indexOf(e.label);this.selectOne.splice(t,1)}if(this.checkOne.includes(e)){var a=this.checkOne.indexOf(e);this.checkOne.splice(a,1)}}}},te={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{staticStyle:{height:"400px"}},[a("el-form-item",{staticStyle:{float:"left",height:"100%",width:"50%","overflow-y":"auto","overflow-x":"hidden"}},[a("el-checkbox-group",{model:{value:e.selectOne,callback:function(t){e.selectOne=t},expression:"selectOne"}},e._l(e.data,function(t,n){return a("el-checkbox",{key:n,staticStyle:{width:"100%"},attrs:{label:t.label,disabled:e.contact.onMember.includes(t.key),checked:t.checked},on:{change:function(a){return e.handleCheckedCitiesChange(t)}}},[a("el-avatar",{staticStyle:{"vertical-align":"middle"},attrs:{size:35,src:t.avatar,shape:"square"}}),e._v(" "),a("span",[e._v(" "+e._s(t.label))])],1)}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{float:"right",height:"90%",width:"50%","overflow-y":"auto","overflow-x":"hidden"}},e._l(e.checkOne,function(t,n){return a("div",{staticStyle:{width:"100%"}},[a("span",{staticClass:"el-checkbox__label"},[a("el-avatar",{staticStyle:{"vertical-align":"middle"},attrs:{size:35,src:t.avatar,shape:"square"}}),e._v(" "),a("span",[e._v(" "+e._s(t.label))])],1),e._v(" "),a("span",{staticStyle:{cursor:"pointer",outline:"0","line-height":"40px","vertical-align":"middle",float:"right"},on:{click:function(a){return e.deleteMember(t)}}},[a("i",{staticClass:"el-icon-circle-close"})])])}),0),e._v(" "),a("el-form-item",{staticStyle:{float:"right",height:"10%",width:"50%"}},[a("el-button",{staticStyle:{float:"right","margin-left":"7px"},attrs:{size:"mini"},on:{click:e.close}},[e._v("取消")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"user"===e.contact.type,expression:"contact.type === 'user'"}],staticStyle:{float:"right"},attrs:{type:"success",size:"mini"},on:{click:e.onCreate}},[e._v("立即创建")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"group"===e.contact.type,expression:"contact.type === 'group'"}],staticStyle:{float:"right"},attrs:{type:"success",size:"mini"},on:{click:e.onAdd}},[e._v("添加到群")])],1)],1)},staticRenderFns:[]};var ae={components:{SelectContactVue:a("VU/8")(ee,te,!1,function(e){a("fsqw")},null,null).exports},data:function(){return{selectVisible:!1}},props:["contact"],mounted:function(){},beforeUpdate:function(){},methods:{open:function(){this.selectVisible=!0},close:function(){this.selectVisible=!1},formSubmit:function(){var e=this;if(""==this.contact.avatar)return this.$message.error("请上传头像"),!1;if(""==this.contact.displayName)return this.$message.error("请填写群昵称"),!1;var t={group_id:this.contact.id,avatar:this.contact.avatar,name:this.contact.displayName};return j(t).then(function(t){0===t.code&&e.$message.success("修改成功")}).catch(function(t){e.$message.error("修改失败")}),!1},beforeAvatarUpload:function(e){var t=this,a="image/jpeg"===e.type,n=e.size/1024/1024<2;if(!a)return this.$message.error("上传头像图片只能是 JPG 格式!"),!1;if(!n)return this.$message.error("上传头像图片大小不能超过 2MB!"),!1;var i=new FormData;i.append("file",e,e.name),z(i,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){0===e.code&&(t.contact.avatar=e.data.AccessUrl)}).catch(function(e){t.$message.error("上传文件超时！")})}}},ne={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticStyle:{"box-shadow":"0 2px 12px 0 rgba(0, 0, 0, 0.1)"}},[a("el-header",{attrs:{height:"auto"}},[a("el-row",{attrs:{gutter:20}},[a("div",{staticClass:"info-box"},[a("div",{staticClass:"grid-content"},[a("el-button",{staticClass:"button-icon",on:{click:e.open}},[a("i",{staticClass:"el-icon-plus"})]),e._v(" "),a("div",{staticClass:"displayName"},[e._v("添加")])],1)]),e._v(" "),"user"==e.contact.type?[a("div",{staticClass:"info-box"},[a("div",{staticClass:"grid-content"},[e.contact.avatar?a("img",{staticClass:"contact_avatar",attrs:{src:e.contact.avatar}}):e._e(),e._v(" "),e.contact.avatar?e._e():a("span",{staticClass:"lemon-avatar contact_avatar"},[a("i",{staticClass:"lemon-icon-people"})]),e._v(" "),a("div",{staticClass:"displayName"},[e._v(e._s(e.contact.displayName))])])])]:e._e(),e._v(" "),"group"==e.contact.type?[e._l(e.contact.members,function(t){return[a("div",{staticClass:"info-box"},[a("div",{staticClass:"grid-content"},[t.user_avatar?a("img",{staticClass:"contact_avatar",attrs:{src:t.user_avatar}}):e._e(),e._v(" "),t.user_avatar?e._e():a("span",{staticClass:"lemon-avatar contact_avatar"},[a("i",{staticClass:"lemon-icon-people"})]),e._v(" "),a("div",{staticClass:"displayName"},[e._v(e._s(t.username))])])])]})]:e._e()],2)],1),e._v(" "),a("el-divider"),e._v(" "),a("el-main",["group"==e.contact.type?[a("el-form",{ref:"form",attrs:{"label-width":"60px"}},[a("el-form-item",{attrs:{label:"群头像"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"#","show-file-list":!1,"before-upload":e.beforeAvatarUpload}},[e.contact.avatar?a("img",{staticClass:"avatar",attrs:{src:e.contact.avatar}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"群昵称"}},[a("el-input",{model:{value:e.contact.displayName,callback:function(t){e.$set(e.contact,"displayName",t)},expression:"contact.displayName"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.formSubmit}},[e._v("立即提交")])],1)],1)]:e._e()],2),e._v(" "),a("el-dialog",{staticStyle:{"text-align":"center"},attrs:{visible:e.selectVisible,center:"","append-to-body":!0,"lock-scroll":!1,"destroy-on-close":!0,width:"500px"},on:{"update:visible":function(t){e.selectVisible=t}}},[a("SelectContactVue",{attrs:{contact:e.contact},on:{close:e.close}})],1)],1)},staticRenderFns:[]};var ie=a("VU/8")(ae,ne,!1,function(e){a("jU9b")},null,null).exports,se=a("HhTG"),oe={name:"VideoPlayer",props:{options:{type:Object,default:function(){return{}}}},data:function(){return{player:null}},mounted:function(){this.player=Object(se.a)(this.$refs.videoPlayer,this.options,function(){})},beforeDestroy:function(){this.player&&this.player.dispose()}},re={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("video",{ref:"videoPlayer",staticClass:"video-js"})])},staticRenderFns:[]},ce=a("VU/8")(oe,re,!1,null,null,null).exports,le={components:{UserFormVue:K,ContactInfoVue:ie,"el-image-viewer":function(){return a.e(0).then(a.bind(null,"5Wmi"))},VideoPlayer:ce},data:function(){return{theme:"default",user:{id:0,displayName:"",avatar:""},messages:[],contacts:[],userInfoBox:!1,imageSuccess:!0,groupInfo:{},showViewer:!1,imgList:[],showVideo:!1,videoOptions:{autoplay:!0,controls:!0,sources:[{src:"",type:"video/mp4"}]}}},mounted:function(){var e=this,t=this.$refs.IMUI;w(S),q(this);var a=this;setTimeout(function(){a.getUserContacts(t)},1e3),setTimeout(function(){C(function(a){var n=JSON.parse(a.data);if("add_member"==n.type||"create_group"==n.type){var i=[];n.members.forEach(function(e){i.push(e.uuid)}),e.contacts.forEach(function(t,a){t.id==n.uuid&&e.contacts.splice(a,1)});var s={id:n.uuid,displayName:n.name,avatar:n.avatar,index:"群聊",unread:0,type:"group",members:n.members,onMember:i,lastContent:t.lastContentRender({type:n.message.type,content:n.message.content}),lastSendTime:n.message.send_time};e.contacts.push(s)}else t.appendMessage(n,!0)})},1e3)},destroyed:function(){},methods:{getUserContacts:function(e){var t=this;0!=this.user.id&&(T().then(function(a){0===a.code&&a.data.forEach(function(a){var n={id:a.uuid,displayName:a.username,avatar:a.avatar,index:"好友",unread:0,type:"user",onMember:[a.uuid]};a.message&&""!=a.message.type&&(n.lastContent=e.lastContentRender({type:a.message.type,content:a.message.content}),n.lastSendTime=a.message.send_time),t.contacts.push(n)})}),F().then(function(a){0===a.code&&a.data.forEach(function(a){var n={id:a.uuid,displayName:a.name,avatar:a.avatar,index:"群聊",unread:0,type:"group",members:a.members,onMember:[]};a.members.forEach(function(e){n.onMember.push(e.uuid)}),a.message&&""!=a.message.type&&(n.lastContent=e.lastContentRender({type:a.message.type,content:a.message.content}),n.lastSendTime=a.message.send_time),t.contacts.push(n)})}),e.initContacts(this.contacts))},handleChangeContact:function(e,t){P(e,t)},handleClickMessage:function(e,t,a,n){"image"==a.type&&(this.imgList=[],this.showViewer=!0,this.imgList.push(a.content)),"file"==a.type&&Q(a,this)},handleChangeMenu:function(){this.$refs.IMUI.closeDrawer()},handleMenuAvatarClick:function(){this.userInfoBox=!this.userInfoBox},handlePullMessages:function(e,t){R(e,t,this)},handleSend:function(e,t,a){X(e,a,this),this.imageSuccess?setTimeout(function(){t(),k(e)},1e3):t({status:"failed"})},userInfoClose:function(){this.userInfoBox=!this.userInfoBox},userInfoEdit:function(e){this.user.displayName=e.displayName,this.user.avatar=e.avatar},changeDrawer:function(e){var t=this.$createElement,a=this.$refs.IMUI;if(!0===a.drawerVisible)a.closeDrawer();else{this.$store.commit("changeContact",e);var n={render:function(e){return t(ie,{attrs:{contact:e}})},width:250,offsetY:1};a.openDrawer(n)}}}},ue={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"imui-center"},[a("vue-particles",{attrs:{color:"#fff",particleOpacity:.7,particlesNumber:60,shapeType:"circle",particleSize:4,linesColor:"#fff",linesWidth:1,lineLinked:!0,lineOpacity:.4,linesDistance:150,moveSpeed:2,hoverEffect:!0,hoverMode:"grab",clickEffect:!0,clickMode:"push"}}),e._v(" "),a("div",{staticClass:"chat-box"},[a("lemon-imui",{ref:"IMUI",attrs:{user:this.user,theme:e.theme,width:"850px",height:"600px"},on:{"pull-messages":e.handlePullMessages,send:e.handleSend,"menu-avatar-click":e.handleMenuAvatarClick,"change-menu":e.handleChangeMenu,"change-contact":e.handleChangeContact,"message-click":e.handleClickMessage},scopedSlots:e._u([{key:"message-title",fn:function(t){return[a("span",{staticClass:"lemon-container__displayname"},[e._v(e._s(t.displayName))]),e._v(" "),a("i",{staticClass:"more el-icon-more",on:{click:function(a){return e.changeDrawer(t)}}}),e._v(" "),a("br")]}}])})],1),e._v(" "),a("el-drawer",{attrs:{title:"编辑用户资料",visible:e.userInfoBox,direction:"rtl"},on:{"update:visible":function(t){e.userInfoBox=t}}},[a("UserFormVue",{on:{userInfoClose:e.userInfoClose,userInfoEdit:e.userInfoEdit}})],1),e._v(" "),e.showViewer?a("el-image-viewer",{attrs:{"on-close":function(){e.showViewer=!1},"url-list":e.imgList}}):e._e(),e._v(" "),e.showVideo?a("div",{staticClass:"mask",on:{click:function(){e.showVideo=!1}}}):e._e(),e._v(" "),e.showVideo?a("div",{staticClass:"videomasks"},[a("VideoPlayer",{attrs:{options:e.videoOptions}})],1):e._e()],1)},staticRenderFns:[]};var de=a("VU/8")(le,ue,!1,function(e){a("mmE2")},null,null).exports,fe=a("NC6I"),pe=a.n(fe),me={data:function(){return{userName:"",password:"",isBtnLoading:!1}},created:function(){JSON.parse(localStorage.getItem("access-user"))&&JSON.parse(localStorage.getItem("access-user")).displayName&&(this.userName=JSON.parse(localStorage.getItem("access-user")).displayName)},computed:{btnText:function(){return this.isBtnLoading?"登录中...":"登录"}},methods:{login:function(){if(this.userName)if(this.password){this.isBtnLoading=!0;var e={username:this.userName,password:pe()(this.password)},t=this;V(e).then(function(e){if(0===e.code){t.isBtnLoading=!1;var a={id:e.data.id,displayName:e.data.username,avatar:e.data.avatar,token:e.data.token,timestamp:(new Date).getTime()};localStorage.setItem("access-user",f()(a)),t.$router.replace({path:"/im"})}else t.isBtnLoading=!1,t.$message.error(e.msg)}).catch(function(e){t.isBtnLoading=!1})}else this.$message.error("请输入密码");else this.$message.error("请输入用户名")}}},he={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login_box"},[a("vue-particles",{attrs:{color:"#fff",particleOpacity:.7,particlesNumber:60,shapeType:"circle",particleSize:4,linesColor:"#fff",linesWidth:1,lineLinked:!0,lineOpacity:.4,linesDistance:150,moveSpeed:2,hoverEffect:!0,hoverMode:"grab",clickEffect:!0,clickMode:"push"}}),e._v(" "),a("div",{staticClass:"login-s"},[a("el-form",{staticClass:"login_form",attrs:{"label-width":"0px"}},[a("el-form-item",{attrs:{label:""}},[a("el-input",{staticClass:"qxs-icon",attrs:{type:"text","prefix-icon":"el-icon-user",placeholder:"用户名"},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-input",{staticClass:"qxs-icon",attrs:{type:"text","prefix-icon":"el-icon-unlock",placeholder:"密码","show-password":""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-button",{staticClass:"login_btn",attrs:{type:"primary",round:"",loading:e.isBtnLoading},on:{click:e.login}},[e._v("登录")])],1)],1)],1)],1)},staticRenderFns:[]};var ve=a("VU/8")(me,he,!1,function(e){a("SfA+")},null,null).exports;n.default.use(u.a);var ge=u.a.prototype.push;u.a.prototype.push=function(e){return ge.call(this,e).catch(function(e){return e})};var ye=[{path:"/",redirect:"/login"},{path:"/login",name:"login",component:ve},{path:"/im",name:"im",component:de}],be=new u.a({routes:ye}),_e=a("bSIt");n.default.use(_e.a);var ke=new _e.a.Store({state:{contact:[]},mutations:{changeContact:function(e,t){e.contact=t}}}),Ce=a("qukJ");a("7MWu");n.default.use(l.a),n.default.use(r.a),n.default.config.productionTip=!1,n.default.use(Ce.a),new n.default({el:"#app",router:be,store:ke,components:{App:s},template:"<App/>"})},"SfA+":function(e,t){},"U4/P":function(e,t){},XTZt:function(e,t){},fsqw:function(e,t){},jU9b:function(e,t){},mmE2:function(e,t){},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.53f910f75d7ffad7774d.js.map